"0","url <- ""https://raw.githubusercontent.com/thiagobodruk/biblia/master/xml/nvi.min.xml"""
"0",""
"0","books <- read_xml(url) %>% "
"0","  xml_children()"
"0",""
"0","books_names <- xml_attr(books, ""name"")"
"0",""
"0","old_testament <- books_names[1:which(books_names == ""Malaquias"")]"
"0",""
"0","read_chapter <- function(chapter, n) {"
"0","  text <- chapter %>% "
"0","    xml_children() %>% "
"0","    xml_text()"
"0","  "
"0","  tibble(capitulo = n, versiculo = seq_along(text), text = text)"
"0","}"
"0",""
"0","read_book <- function(book) {"
"0","  book_name <- xml_attr(book, ""name"")"
"0","  "
"0","  chapters <- xml_children(book)"
"0","  "
"0","  imap_dfr(chapters, ~read_chapter(.x, .y)) %>% "
"0","    mutate(livro = book_name,"
"0","           testamento = if_else(livro %in% old_testament,"
"0","                                ""Velho Testamento"","
"0","                                ""Novo Testamento"")) %>% "
"0","    select(testamento, livro, everything())"
"0","}"
"0",""
"0","bible <- books %>% "
"0","  map_dfr(read_book) %>% "
"0","  mutate(livro = factor(livro, levels = xml_attr(books, ""name"")))"
"0",""
"0","bible <- books %>% "
"0","  map_dfr(read_book) %>% "
"0","  mutate(testamento = factor(testamento, levels = c(""Velho Testamento"","
"0","                                                    ""Novo Testamento"")),"
"0","         livro = factor(livro, levels = books_names))"
"0",""
"0","readr::write_csv(bible, ""datasets/bible.csv"")"
